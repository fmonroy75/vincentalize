

// Datos de la música de Vincentalize
const musicData = {
    royaumes_album: {
        title: "Nos royaumes interdits (album)",
        image: "assets/img/nos_royaumes_interdits_album.jpg",
        year: "2021",
        tracks: [
            { 
                title: "xxxx", 
                duration: "3:45",
                src:"assets/mp3/beep.mp3",
                lyrics: "xxxx"
            },
            { 
                title: "xxxx", 
                duration: "3:45",
                src:"assets/mp3/beep.mp3",
                lyrics: "xxxx"
            },
            { 
                title: "xxxx", 
                duration: "3:45",
                src:"assets/mp3/beep.mp3",
                lyrics: "xxxx"
            },
            { 
                title: "xxxx", 
                duration: "3:45",
                src:"assets/mp3/beep.mp3",
                lyrics: "xxxx"
            },
            { 
                title: "xxxx", 
                duration: "3:45",
                src:"assets/mp3/beep.mp3",
                lyrics: "xxxx"
            },
            { 
                title: "xxxx", 
                duration: "3:45",
                src:"assets/mp3/beep.mp3",
                lyrics: "xxxx"
            },
            { 
                title: "xxxx", 
                duration: "3:45",
                src:"assets/mp3/beep.mp3",
                lyrics: "xxxx"
            },
            { 
                title: "xxxx", 
                duration: "3:45",
                src:"assets/mp3/beep.mp3",
                lyrics: "xxxx"
            },
            { 
                title: "xxxx", 
                duration: "3:45",
                src:"assets/mp3/beep.mp3",
                lyrics: "xxxx"
            },
            { 
                title: "xxxx", 
                duration: "3:45",
                src:"assets/mp3/beep.mp3",
                lyrics: "xxxx"
            },
            { 
                title: "xxxx", 
                duration: "3:45",
                src:"assets/mp3/beep.mp3",
                lyrics: "xxxx"
            },
            { 
                title: "xxxx", 
                duration: "3:45",
                src:"assets/mp3/beep.mp3",
                lyrics: "xxxx"
            },
        ]
    },
    royaumes_single: {
        title: "Nos royaumes interdits (single)",
        image: "assets/img/nos_royaumes_interdits_single.jpg",
        year: "2021",
        tracks: [
            { 
                title: "Nos royaumes interdits (single)", 
                duration: "3:56",
                src:"assets/mp3/beep.mp3",
                lyrics: "Comme deux étoiles filantes\nQui déchirent la noirceur de la nuit\nÀ la croisée des mondes\nNos royaumes interdits\n\nJ’ai rêvé de nos jours\nDe nos nuits, nos fantaisies\nJ’ai rêvé de notre amour\nDans une autre vie\n\nNous sommes les héros d’une tragédie\nDont tout le monde sait\ncomment ça finit\nDans le vin et le sang, on célébrera notre mort\nOn brûlera toutes les pages de notre histoire\nIl ne restera plus rien de nous que l’oubli\n\nNos royaumes interdits\n\nJ’ai rêvé de nos jours\nDe nos nuits, nos fantaisies\nJ’ai rêvé de notre amour\nDans une autre vie\n\nNos royaumes interdits"
            },
        ]
    },
    météore: {
        title: "Ma météore",
        image: "assets/img/ma_meteore.jpg",
        year: "2021",
        tracks: [
            { 
                title: "Ma météore", 
                duration: "5:51",
                src:"assets/mp3/beep.mp3",
                lyrics: ""
            },
        ]
    },
    Dans: {
        title: "Dans tes bras (single)",
        image: "assets/img/dans_tes_bras.jpg",
        year: "2020",
        tracks: [
            { 
                title: "Dans tes bras", 
                duration: "4:17",
                src:"assets/mp3/beep.mp3",
                lyrics: ""
            },
        ]
    },
    Aujourd: {
        title: "Aujourd'hui (single)",
        image: "assets/img/aujourdhui.jpg",
        year: "2020",
        tracks: [
            { 
                title: "Aujourd'hui", 
                duration: "6:17",
                src:"assets/mp3/beep.mp3",
                lyrics: "Tu es maintenant partie\nComme le soleil, la nuit\nDans un éclair, ébloui\nEt le tonnerre, mon cri\n\nTu es encore ici\nTu es toute ma vie\nUne seconde, l’infini\nEt sombrons dans l’oubli\n\nTu es mon désert, ma pluie\nMon cœur, un incendie\nL’étranger que je suis\nAujourd’hui\n\nTu es mon désert, ma pluie\nMon cœur, un incendie\nLe brasier que je fuis\nAujourd’hui\n\nTu es ma belle noirceur\nLe grand vide des heures\nMon vertige des grandeurs\nL’inconnu, la peur\n\nTu n’es plus qu’une abstraction\nL’hologramme de mes fictions\nDans un monde de fractions\nOù je perds la raison\n\nTu es mon désert, ma pluie\nMon cœur, un incendie\nL’étranger que je suis\nAujourd’hui\n\nTu es mon désert, ma pluie\nMon cœur, un incendie\nLe brasier que je fuis\nAujourd’hui"
            },
        ]
    },
    Notre: {
        title: "Notre terre qui était (single)",
        image: "assets/img/notre_terre_qui_etait.jpg",
        year: "2019",
        tracks: [
            { 
                title: "Notre terre qui était", 
                duration: "5:59",
                src:"assets/mp3/beep.mp3",
                lyrics: "Voix et guitare : Vincent Alizé\nPiano: Jean-François Racine\nDrum: Rafael Poggetti\nVioloncelle: Marie-Philippe Lemay\n\nRéalisation musicale: Luc Boivin et Vincent Alizé au studio Redtube\nMixage: Luc Boivin\nMastering: Yannick St-Amand\nMaison de disque: Les Disques Inconnu\nparoles\nSorti d’un rêve où tout était parfait\nLes couleurs se mêlaient à la lumière\nL’amour se croyait pour l’univers\n\nÀ l’abri des jours sans l’ombre d’un reflet\nMême la noirceur brillait au fond de tes yeux\nUn soleil se levait sur notre terre qui était\n\nMon monde est à l’envers\nJe retombe sur terre\nMon cœur et des poussières\nS’allongent mes déserts\n\nJ’ai grandi dans tes bras\nComme un arbre à la fois\nMa foret sacrée, mon palais\nDe fougères et de fleurs\nQui suivaient nos pas\n\nJ’ai vieilli soudain\nLa seconde de ma vie\nPassée en une seule nuit\nSans faire de bruit\nLes yeux tournés vers toi\n\nMon monde est à l’envers\nJe retombe sur terre\nMon cœur et des poussières\nS’allongent mes déserts\n\nMon monde est à l’envers\nJe retombe sur terre\nMon cœur est de poussière\nS’allongent mes déserts"
            },
        ]
    },
    Deux: {
        title: "Deux souffles (mini-album)",
        image: "assets/img/deus_soufles.jpg",
        year: "2018",
        tracks: [
            { 
                title: "Quelques lueurs", 
                duration: "3:58",
                src:"assets/mp3/beep.mp3",
                lyrics: ""
            },
            { 
                title: "Nous reviendrons", 
                duration: "3:43",
                src:"assets/mp3/beep.mp3",
                lyrics: ""
            },
        ]
    },
    
};
// Variables del reproductor
let currentAlbum = 'royaumes_album'; // CORREGIDO: álbum que existe
let currentTrackIndex = 0;
let audio = new Audio();
let isPlaying = false;

// Elementos del DOM
const albumOptions = document.querySelectorAll('.album-option');
const trackSelector = document.querySelector('.track-selector');
const nowPlayingImage = document.getElementById('nowPlayingImage');
const nowPlayingTitle = document.getElementById('nowPlayingTitle');
const nowPlayingAlbum = document.getElementById('nowPlayingAlbum');
const playPauseBtn = document.getElementById('playPauseBtn');
const prevBtn = document.getElementById('prevBtn');
const nextBtn = document.getElementById('nextBtn');
const progress = document.getElementById('progress');
const progressBar = document.getElementById('progressBar');
const currentTimeEl = document.getElementById('currentTime');
const durationEl = document.getElementById('duration');
const lyricsToggle = document.getElementById('lyricsToggle');
const lyricsContent = document.getElementById('lyricsContent');
const lyricsText = document.getElementById('lyricsText');
const lyricsIcon = document.getElementById('lyricsIcon');

// AÑADIR ESTO AL HTML o crear el control de volumen dinámicamente
function createVolumeControl() {
const playerControls = document.querySelector('.player-controls');
const volumeControl = document.createElement('div');
volumeControl.className = 'volume-control';
volumeControl.innerHTML = `
<i class="fas fa-volume-up"></i>
<input type="range" id="volumeSlider" class="volume-slider" min="0" max="100" value="50">
`;
playerControls.appendChild(volumeControl);
return document.getElementById('volumeSlider');
}

// Inicialización
document.addEventListener('DOMContentLoaded', function() {
// Crear control de volumen
const volumeSlider = createVolumeControl();

// Animación al hacer scroll
const fadeElements = document.querySelectorAll('.fade-in');

const fadeInOnScroll = function() {
fadeElements.forEach(element => {
    const elementTop = element.getBoundingClientRect().top;
    const elementVisible = 150;
    
    if (elementTop < window.innerHeight - elementVisible) {
        element.classList.add('visible');
    }
});
};

fadeInOnScroll();
window.addEventListener('scroll', fadeInOnScroll);

// Navegación suave
document.querySelectorAll('a[href^="#"]').forEach(anchor => {
anchor.addEventListener('click', function (e) {
    e.preventDefault();
    
    const targetId = this.getAttribute('href');
    if (targetId === '#') return;
    
    const targetElement = document.querySelector(targetId);
    if (targetElement) {
        window.scrollTo({
            top: targetElement.offsetTop - 80,
            behavior: 'smooth'
        });
        
        // Cerrar menú móvil si está abierto
        const navLinks = document.querySelector('.nav-links');
        if (navLinks) {
            navLinks.classList.remove('active');
        }
    }
});
});

// Menú hamburguesa para móviles
const hamburger = document.querySelector('.hamburger');
const navLinks = document.querySelector('.nav-links');

if (hamburger) {
hamburger.addEventListener('click', function() {
    navLinks.classList.toggle('active');
});
}

// Efecto de cambio de header al hacer scroll
window.addEventListener('scroll', function() {
const header = document.querySelector('header');
if (window.scrollY > 100) {
    header.style.padding = '0.7rem 0';
    header.style.backgroundColor = 'rgba(13, 20, 36, 0.98)';
} else {
    header.style.padding = '1rem 0';
    header.style.backgroundColor = 'rgba(13, 20, 36, 0.95)';
}
});

// Configurar selectores de álbum
albumOptions.forEach(option => {
option.addEventListener('click', function() {
    const albumKey = this.getAttribute('data-album');
    selectAlbum(albumKey);
});
});

// Controles del reproductor
playPauseBtn.addEventListener('click', togglePlayPause);
prevBtn.addEventListener('click', playPreviousTrack);
nextBtn.addEventListener('click', playNextTrack);

// Control de volumen
volumeSlider.addEventListener('input', function() {
audio.volume = this.value / 100;
});

// Control de progreso
progressBar.addEventListener('click', setProgress);

// Eventos del audio
audio.addEventListener('loadedmetadata', updateDuration);
audio.addEventListener('timeupdate', updateProgress);
audio.addEventListener('ended', playNextTrack);

// Toggle de letras
lyricsToggle.addEventListener('click', function() {
lyricsContent.classList.toggle('active');
lyricsIcon.classList.toggle('fa-chevron-down');
lyricsIcon.classList.toggle('fa-chevron-up');
});

// Cargar álbum inicial CORREGIDO
selectAlbum('royaumes_album');

// Configurar volumen inicial
audio.volume = volumeSlider.value / 100;
});

// Funciones del reproductor
function selectAlbum(albumKey) {
// Actualizar selector de álbum
albumOptions.forEach(option => {
if (option.getAttribute('data-album') === albumKey) {
    option.classList.add('active');
} else {
    option.classList.remove('active');
}
});

currentAlbum = albumKey;
currentTrackIndex = 0;

// Actualizar información del álbum
const album = musicData[albumKey];
nowPlayingImage.src = album.image;
nowPlayingAlbum.textContent = `${album.title} (${album.year})`;

// Generar lista de pistas
trackSelector.innerHTML = '';
album.tracks.forEach((track, index) => {
const trackOption = document.createElement('div');
trackOption.className = 'track-option';
if (index === currentTrackIndex) {
    trackOption.classList.add('active');
}
trackOption.innerHTML = `
    <div class="track-number">${index + 1}</div>
    <div class="track-info">
        <div class="track-title">${track.title}</div>
        <div class="track-duration">${track.duration}</div>
    </div>
`;
trackOption.addEventListener('click', () => {
    selectTrack(index);
});
trackSelector.appendChild(trackOption);
});

// Cargar primera pista
selectTrack(0);
}

function selectTrack(index) {
// Pausar audio actual si está reproduciendo
if (isPlaying) {
audio.pause();
isPlaying = false;
playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
}

// Actualizar selector de pistas
document.querySelectorAll('.track-option').forEach((option, i) => {
if (i === index) {
    option.classList.add('active');
} else {
    option.classList.remove('active');
}
});

currentTrackIndex = index;
const track = musicData[currentAlbum].tracks[index];

// Actualizar información de reproducción
nowPlayingTitle.textContent = track.title;
lyricsText.textContent = track.lyrics || "No hay letra disponible para esta canción";

// Reiniciar progreso
progress.style.width = '0%';
currentTimeEl.textContent = '0:00';
durationEl.textContent = track.duration;

// Cargar el audio
audio.src = track.src;
audio.load();

console.log(`Cargando: ${track.src}`); // Para debugging
}

function togglePlayPause() {
if (isPlaying) {
pauseAudio();
} else {
playAudio();
}
}

function playAudio() {
if (!audio.src) {
selectTrack(currentTrackIndex);
}

audio.play().then(() => {
isPlaying = true;
playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
}).catch(e => {
console.log("Error al reproducir audio:", e);
alert("No se pudo reproducir el audio. Asegúrate de que los archivos MP3 estén en la carpeta assets/mp3/");
});
}

function pauseAudio() {
audio.pause();
isPlaying = false;
playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
}

function playPreviousTrack() {
currentTrackIndex--;
if (currentTrackIndex < 0) {
currentTrackIndex = musicData[currentAlbum].tracks.length - 1;
}
selectTrack(currentTrackIndex);
}

function playNextTrack() {
currentTrackIndex++;
if (currentTrackIndex >= musicData[currentAlbum].tracks.length) {
currentTrackIndex = 0;
}
selectTrack(currentTrackIndex);
}

function updateDuration() {
const duration = audio.duration;
if (!isNaN(duration)) {
durationEl.textContent = formatTime(duration);
}
}

function updateProgress() {
const currentTime = audio.currentTime;
const duration = audio.duration;

if (duration && !isNaN(duration)) {
const progressPercent = (currentTime / duration) * 100;
progress.style.width = `${progressPercent}%`;

currentTimeEl.textContent = formatTime(currentTime);
}
}

function setProgress(e) {
const width = this.clientWidth;
const clickX = e.offsetX;
const duration = audio.duration;

if (duration && !isNaN(duration)) {
audio.currentTime = (clickX / width) * duration;
}
}

function formatTime(seconds) {
if (isNaN(seconds)) return '0:00';

const mins = Math.floor(seconds / 60);
const secs = Math.floor(seconds % 60);
return `${mins}:${secs < 10 ? '0' : ''}${secs}`;
}
